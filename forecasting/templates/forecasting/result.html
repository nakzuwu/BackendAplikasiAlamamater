    <!DOCTYPE html>
    <html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Hasil Peramalan Jas Almamater</title>

        <!-- Bootstrap 5 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <!-- Bootstrap Icons -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" />

        <style>
            :root {
                --bg-primary: #0d1117;
                --bg-secondary: #161b22;
                --bg-card: #21262d;
                --text-primary: #f0f6fc;
                --text-secondary: #8b949e;
                --accent-primary: #58a6ff;
                --accent-secondary: #1f6feb;
                --border-color: #30363d;
                --success: #3fb950;
                --warning: #d29922;
                --danger: #f85149;
            }

            body {
                background-color: var(--bg-primary);
                color: var(--text-primary);
                min-height: 100vh;
                font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
                transition: all 0.3s ease;
            }

            .container {
                max-width: 1400px;
                margin-top: 40px;
                margin-bottom: 60px;
            }

            .card {
                background-color: var(--bg-card);
                border: 1px solid var(--border-color);
                border-radius: 12px;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
            }

            .table {
                color: var(--text-primary);
                border-color: var(--border-color);
            }

            .table th {
                background-color: var(--accent-secondary);
                color: white;
                text-align: center;
                vertical-align: middle;
                font-weight: 600;
                border: none;
                padding: 12px 8px;
            }

            .table td {
                text-align: center;
                vertical-align: middle;
                padding: 12px 8px;
                border-color: var(--border-color);
            }

            .table-striped tbody tr:nth-of-type(odd) {
                background-color: rgba(255, 255, 255, 0.03);
            }

            .table-striped tbody tr:nth-of-type(even) {
                background-color: rgba(255, 255, 255, 0.06);
            }

            .table-striped tbody tr:hover {
                background-color: rgba(88, 166, 255, 0.1);
            }

            .btn-primary {
                background-color: var(--accent-primary);
                border-color: var(--accent-primary);
                color: white;
                font-weight: 500;
                padding: 10px 20px;
                border-radius: 8px;
                transition: all 0.3s ease;
            }

            .btn-primary:hover {
                background-color: var(--accent-secondary);
                border-color: var(--accent-secondary);
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(31, 111, 235, 0.3);
            }

            .btn-secondary {
                background-color: var(--bg-secondary);
                border-color: var(--border-color);
                color: var(--text-primary);
                padding: 10px 20px;
                border-radius: 8px;
                transition: all 0.3s ease;
            }

            .btn-secondary:hover {
                background-color: var(--border-color);
                border-color: var(--text-secondary);
                transform: translateY(-2px);
            }

            .alert-danger {
                background-color: rgba(248, 81, 73, 0.15);
                border-color: var(--danger);
                color: var(--danger);
                border-radius: 8px;
            }

            h1, h2, h3, h4, h5, h6 {
                color: var(--text-primary);
                font-weight: 600;
            }

            .text-primary {
                color: var(--accent-primary) !important;
            }

            .text-secondary {
                color: var(--text-secondary) !important;
            }

            .text-muted {
                color: var(--text-secondary) !important;
            }

            #multiChart, #yearlyChart {
                width: 100% !important;
                min-height: 350px;
                max-height: 500px;
            }

            .header-icon {
                font-size: 1.8rem;
                margin-right: 10px;
                vertical-align: middle;
            }

            .metric-highlight {
                background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
                color: white;
                padding: 4px 10px;
                border-radius: 6px;
                font-weight: 600;
            }

            .metric-container {
                display: flex;
                justify-content: space-between;
                flex-wrap: wrap;
                gap: 15px;
                margin-bottom: 25px;
            }

            .metric-card {
                flex: 1;
                min-width: 200px;
                background-color: var(--bg-secondary);
                border-radius: 10px;
                padding: 15px;
                text-align: center;
                border-left: 4px solid var(--accent-primary);
            }

            .metric-value {
                font-size: 1.8rem;
                font-weight: 700;
                margin: 10px 0;
                color: var(--accent-primary);
            }

            .metric-label {
                font-size: 0.9rem;
                color: var(--text-secondary);
            }

            .footer {
                margin-top: 40px;
                padding: 20px 0;
                text-align: center;
                color: var(--text-secondary);
                font-size: 0.9rem;
                border-top: 1px solid var(--border-color);
            }

            .theme-toggle {
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: var(--bg-card);
                border: 1px solid var(--border-color);
                border-radius: 50%;
                width: 50px;
                height: 50px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 1000;
                transition: all 0.3s ease;
            }

            .theme-toggle:hover {
                transform: rotate(15deg);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }

            .calculation-card {
                background: var(--bg-secondary);
                border-left: 4px solid var(--accent-primary);
                padding: 15px;
                margin: 10px 0;
                border-radius: 8px;
            }

            .formula {
                font-family: "Courier New", monospace;
                background: var(--bg-primary);
                padding: 12px;
                border-radius: 6px;
                margin: 8px 0;
                border: 1px solid var(--border-color);
                color: var(--accent-primary);
                font-weight: 500;
            }

            .calculation-step {
                background: var(--bg-secondary);
                padding: 10px;
                border-radius: 6px;
                margin: 5px 0;
                border-left: 3px solid var(--success);
            }

            .btn-info {
                background-color: #17a2b8;
                border-color: #17a2b8;
                color: white;
            }

            .btn-info:hover {
                background-color: #138496;
                border-color: #117a8b;
            }

            .method-badge {
                font-size: 0.8rem;
                padding: 4px 8px;
            }

            .best-metric {
                background: linear-gradient(135deg, var(--success), #2ea043);
                color: white;
                font-weight: bold;
                padding: 2px 8px;
                border-radius: 4px;
            }

            @media (max-width: 768px) {
                .container {
                    margin-top: 70px;
                }

                .table-responsive {
                    font-size: 0.85rem;
                }

                .metric-card {
                    min-width: 100%;
                }
            }
            /* Tambahkan di bagian style */
            .btn-danger {
                background: linear-gradient(135deg, #dc3545, #c82333);
                border: none;
                padding: 12px 30px;
                font-weight: 600;
                transition: all 0.3s ease;
            }

            .btn-danger:hover {
                background: linear-gradient(135deg, #c82333, #bd2130);
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
            }

            /* Loading state */
            .btn:disabled {
                opacity: 0.7;
                cursor: not-allowed;
            }
        </style>
    </head>

    <body>
        <div class="container">
            {% if error %}
            <div class="alert alert-danger text-center" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ error }}
            </div>
            <div class="text-center">
                <a href="/" class="btn btn-secondary mt-3">
                    <i class="bi bi-arrow-left me-2"></i>Kembali
                </a>
            </div>
            {% else %}
            <div class="alert alert-info text-center">
    <i class="bi bi-sliders me-2"></i>
    <strong>Presisi Alpha:</strong> 
    {% if alpha_step == 0.01 %}
        Menggunakan Alpha Step 0.01 (99 kombinasi alpha)
    {% else %}
        Menggunakan Alpha Step 0.1 (9 kombinasi alpha)
    {% endif %}
    | 
    <strong>Total Perhitungan:</strong> {{ total_calculations }} kombinasi
</div>

            <div class="text-center mb-5">
                <h1 class="fw-bold text-primary mb-3">
                    <i class="bi bi-graph-up header-icon"></i>Hasil Peramalan Jas Almamater
                </h1>
                <p class="text-muted fs-5">
                    Analisis Prediksi Berdasarkan Multiple Metode Evaluasi
                </p>
            </div>

<!-- Metrics Summary -->
<div class="metric-container">
    <div class="metric-card">
        <div class="metric-label">Total Ukuran</div>
        <div class="metric-value">{{ results|length }}</div>
    </div>
    <div class="metric-card">
        <div class="metric-label">MAPE Terbaik</div>
        <div class="metric-value">{{ best_mape|floatformat:1 }}%</div>
    </div>
    <div class="metric-card">
        <div class="metric-label">MAE Terbaik</div>
        <div class="metric-value">
            {% with best_mae=results|dictsort:"mae"|first %}
                {{ best_mae.mae|floatformat:0 }}
            {% endwith %}
        </div>
    </div>
    <div class="metric-card">
    <div class="metric-label">Alpha Step</div>
    <div class="metric-value">
        {% if alpha_step == 0.01 %}
            0.01 (99)
        {% else %}
            0.1 (9)
        {% endif %}
    </div>
</div>
    <div class="metric-card">
        <div class="metric-label">MSE Terbaik</div>
        <div class="metric-value">
            {% with best_mse=results|dictsort:"mse"|first %}
                {{ best_mse.mse|floatformat:0 }}
            {% endwith %}
        </div>
    </div>
    <div class="metric-card">
        <div class="metric-label">Tahun Prediksi</div>
        <div class="metric-value">{{ results.0.tahun_next }}</div>
    </div>
</div>

<!-- 1. Table Hasil Prediksi menggunakan MAPE Terbaik -->
<div class="card p-4 mb-5">
    <h4 class="text-secondary mb-4 text-center">
        <i class="bi bi-table header-icon"></i>Hasil Prediksi Berdasarkan MAPE Terbaik
    </h4>
    <div class="alert alert-success mb-3">
        <i class="bi bi-info-circle me-2"></i>
        <strong>MAPE (Mean Absolute Percentage Error):</strong> Metode terbaik berdasarkan error persentase terkecil. 
        MAPE < 10% = Akurasi Tinggi, 10-20% = Baik, >20% = Perlu Perbaikan
    </div>

    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead>
                <tr>
                    <th>Ukuran</th>
                    <th>Alpha (α)</th>
                    <th>MAPE (%)</th>
                    <th>MAE</th>
                    <th>MSE</th>
                    <th>Tahun Terakhir</th>
                    <th>Aktual (A<sub>t</sub>)</th>
                    <th>Tahun Berikutnya</th>
                    <th>Forecast (F<sub>t+1</sub>)</th>
                    <th>Trend</th>
                    <th>Detail Perhitungan</th>
                </tr>
            </thead>
            <tbody>
                {% for r in results %}
                <tr>
                    <td><strong>{{ r.ukuran }}</strong></td>
                    <td>
    <span class="badge bg-primary method-badge">
        {% if alpha_step == 0.01 %}
            {{ r.alpha_mape|floatformat:2 }}
        {% else %}
            {{ r.alpha_mape|floatformat:1 }}
        {% endif %}
    </span>
</td>
                    <td>
                        <span class="best-metric">{{ r.mape|floatformat:1 }}%</span>
                    </td>
                    <td>{{ r.mae|floatformat:0 }}</td>
                    <td>{{ r.mse|floatformat:0 }}</td>
                    <td>{{ r.tahun_last }}</td>
                    <td>{{ r.actual_last|floatformat:0 }}</td>
                    <td>{{ r.tahun_next }}</td>
                    <td class="bg-warning bg-opacity-25 fw-bold">
                        {{ r.forecast_next|floatformat:0 }}
                    </td>
                    <td>
                        {% if r.forecast_trend == 'Naik' %}
                            <span class="badge bg-success"><i class="bi bi-arrow-up"></i></span>
                        {% elif r.forecast_trend == 'Turun' %}
                            <span class="badge bg-danger"><i class="bi bi-arrow-down"></i></span>
                        {% else %}
                            <span class="badge bg-secondary"><i class="bi bi-dash"></i></span>
                        {% endif %}
                    </td>
                    <td>
                        <button class="btn btn-sm btn-outline-info" 
                                onclick="showAllCalculations(
                                    '{{ r.ukuran }}', 
                                    {{ r.alpha_mape|floatformat:1 }}, 
                                    {{ r.actual_last|floatformat:0 }}, 
                                    {{ r.forecast_last|floatformat:0 }}, 
                                    {{ r.forecast_next|floatformat:0 }}, 
                                    {{ r.mape|floatformat:1 }},
                                    {{ r.mae|floatformat:0 }},
                                    {{ r.mse|floatformat:0 }},
                                    'MAPE',
                                    {{ r.yearly_calculations|safe }},
                                    {{ r.yearly_metrics|safe }},
                                    {{ r.all_alpha_data|safe }},
                                    {{ alpha_step }}  <!-- Tambahkan alpha_step -->
                                )">
                            <i class="bi bi-calculator me-1"></i>Lihat Detail
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- 2. Table Hasil Prediksi menggunakan MAE Terbaik -->
<div class="card p-4 mb-5">
    <h4 class="text-secondary mb-4 text-center">
        <i class="bi bi-table header-icon"></i>Hasil Prediksi Berdasarkan MAE Terbaik
    </h4>
    <div class="alert alert-info mb-3">
        <i class="bi bi-info-circle me-2"></i>
        <strong>MAE (Mean Absolute Error):</strong> Metode terbaik berdasarkan error absolut terkecil. 
        Semakin kecil MAE semakin akurat prediksi dalam satuan asli data.
    </div>

    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead>
                <tr>
                    <th>Ukuran</th>
                    <th>Alpha (α)</th>
                    <th>MAPE (%)</th>
                    <th>MAE</th>
                    <th>MSE</th>
                    <th>Tahun Terakhir</th>
                    <th>Aktual (A<sub>t</sub>)</th>
                    <th>Tahun Berikutnya</th>
                    <th>Forecast (F<sub>t+1</sub>)</th>
                    <th>Trend</th>
                    <th>Detail Perhitungan</th>
                </tr>
            </thead>
            <tbody>
                {% for r in mae_best_results %}
                <tr>
                    <td><strong>{{ r.ukuran }}</strong></td>
                    <td>
    <span class="badge bg-primary method-badge">
        {% if alpha_step == 0.01 %}
            {{ r.alpha|floatformat:2 }}
        {% else %}
            {{ r.alpha|floatformat:1 }}
        {% endif %}
    </span>
</td>
                    <td>{{ r.mape|floatformat:1 }}%</td>
                    <td>
                        <span class="best-metric">{{ r.mae|floatformat:0 }}</span>
                    </td>
                    <td>{{ r.mse|floatformat:0 }}</td>
                    <td>{{ r.tahun_last }}</td>
                    <td>{{ r.actual_last|floatformat:0 }}</td>
                    <td>{{ r.tahun_next }}</td>
                    <td class="bg-info bg-opacity-25 fw-bold">
                        {{ r.forecast_next|floatformat:0 }}
                    </td>
                    <td>
                        {% if r.forecast_trend == 'Naik' %}
                            <span class="badge bg-success"><i class="bi bi-arrow-up"></i></span>
                        {% elif r.forecast_trend == 'Turun' %}
                            <span class="badge bg-danger"><i class="bi bi-arrow-down"></i></span>
                        {% else %}
                            <span class="badge bg-secondary"><i class="bi bi-dash"></i></span>
                        {% endif %}
                    </td>
                    <td>
                    <button class="btn btn-sm btn-outline-info" 
                            onclick="showAllCalculations(
                                '{{ r.ukuran }}', 
                                {{ r.alpha_mae|default:r.alpha|floatformat:1 }}, 
                                {{ r.actual_last|floatformat:0 }}, 
                                {{ r.forecast_last|default:0|floatformat:0 }}, 
                                {{ r.forecast_next|floatformat:0 }}, 
                                {{ r.mape|floatformat:1 }},
                                {{ r.mae|floatformat:0 }},
                                {{ r.mse|floatformat:0 }},
                                'MAE',
                                {{ r.yearly_calculations|default_if_none:"[]"|safe }},
                                {{ r.yearly_metrics|default_if_none:"[]"|safe }},
                                {{ r.all_alpha_data|default_if_none:"[]"|safe }},
                                {{ alpha_step }}  <!-- Tambahkan alpha_step -->
                            )">
                        <i class="bi bi-calculator me-1"></i>Lihat Detail
                    </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- 3. Table Hasil Prediksi menggunakan MSE Terbaik -->
<div class="card p-4 mb-5">
    <h4 class="text-secondary mb-4 text-center">
        <i class="bi bi-table header-icon"></i>Hasil Prediksi Berdasarkan MSE Terbaik
    </h4>
    <div class="alert alert-warning mb-3">
        <i class="bi bi-info-circle me-2"></i>
        <strong>MSE (Mean Squared Error):</strong> Metode terbaik berdasarkan error kuadrat terkecil. 
        Lebih sensitif terhadap outlier, memberikan penalti lebih besar untuk error yang besar.
    </div>

    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead>
                <tr>
                    <th>Ukuran</th>
                    <th>Alpha (α)</th>
                    <th>MAPE (%)</th>
                    <th>MAE</th>
                    <th>MSE</th>
                    <th>Tahun Terakhir</th>
                    <th>Aktual (A<sub>t</sub>)</th>
                    <th>Tahun Berikutnya</th>
                    <th>Forecast (F<sub>t+1</sub>)</th>
                    <th>Trend</th>
                    <th>Detail Perhitungan</th>
                </tr>
            </thead>
            <tbody>
                {% for r in mse_best_results %}
                <tr>
                    <td><strong>{{ r.ukuran }}</strong></td>
                    <td>
    <span class="badge bg-primary method-badge">
        {% if alpha_step == 0.01 %}
            {{ r.alpha|floatformat:2 }}
        {% else %}
            {{ r.alpha|floatformat:1 }}
        {% endif %}
    </span>
</td>
                    <td>{{ r.mape|floatformat:2 }}%</td>
                    <td>{{ r.mae|floatformat:0 }}</td>
                    <td>
                        <span class="best-metric">{{ r.mse|floatformat:0 }}</span>
                    </td>
                    <td>{{ r.tahun_last }}</td>
                    <td>{{ r.actual_last|floatformat:0 }}</td>
                    <td>{{ r.tahun_next }}</td>
                    <td class="bg-warning bg-opacity-25 fw-bold">`
                        {{ r.forecast_next|floatformat:0 }}
                    </td>
                    <td>
                        {% if r.forecast_trend == 'Naik' %}
                            <span class="badge bg-success"><i class="bi bi-arrow-up"></i></span>
                        {% elif r.forecast_trend == 'Turun' %}
                            <span class="badge bg-danger"><i class="bi bi-arrow-down"></i></span>
                        {% else %}
                            <span class="badge bg-secondary"><i class="bi bi-dash"></i></span>
                        {% endif %}
                    </td>
                    <td>
                    <button class="btn btn-sm btn-outline-info" 
                            onclick="showAllCalculations(
                                '{{ r.ukuran }}', 
                                {{ r.alpha_mse|default:r.alpha|floatformat:1 }}, 
                                {{ r.actual_last|floatformat:0 }}, 
                                {{ r.forecast_last|default:0|floatformat:0 }}, 
                                {{ r.forecast_next|floatformat:0 }}, 
                                {{ r.mape|floatformat:1 }},
                                {{ r.mae|floatformat:0 }},
                                {{ r.mse|floatformat:0 }},
                                'MSE',
                                {{ r.yearly_calculations|default_if_none:"[]"|safe }},
                                {{ r.yearly_metrics|default_if_none:"[]"|safe }},
                                {{ r.all_alpha_data|default_if_none:"[]"|safe }},
                                {{ alpha_step }}  <!-- Tambahkan alpha_step -->
                            )">
                        <i class="bi bi-calculator me-1"></i>Lihat Detail
                    </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="card p-4 mb-5">
    <h4 class="text-secondary mb-4 text-center">
        <i class="bi bi-bar-chart header-icon"></i>Perbandingan Semua Alpha 
        <span class="badge bg-info ms-2">
            {% if alpha_step == 0.01 %}Step 0.01{% else %}Step 0.1{% endif %}
        </span>
    </h4>

    <div class="alert alert-info mb-4">
        <i class="bi bi-info-circle me-2"></i>
        <strong>Total Perhitungan:</strong> {{ total_calculations }} kombinasi 
        ({% if alpha_step == 0.01 %}99{% else %}9{% endif %} alpha × {{ results|length }} ukuran)
    </div>

    {% for ukuran, calculations in all_calculations.items %}
    <div class="mb-4">
        <h5 class="text-primary mb-3">
            <i class="bi bi-graph-up"></i> Ukuran: {{ ukuran }}
            <span class="badge bg-secondary">
                {% if alpha_step == 0.01 %}99{% else %}9{% endif %} Kombinasi Alpha
            </span>
        </h5>

        <div class="table-responsive">
            <table class="table table-sm table-bordered">
                <thead>
                    <tr class="table-dark">
                        <th>Alpha (α)</th>
                        <th>MAPE (%)</th>
                        <th>MAE</th>
                        <th>MSE</th>
                        <th>Keterangan</th>
                        <th>Forecast (F<sub>t+1</sub>)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for calc in calculations %}
                    <tr>
                        <td>
                            <strong>
                                {% if alpha_step == 0.01 %}
                                    {{ calc.alpha|floatformat:2 }}
                                {% else %}
                                    {{ calc.alpha|floatformat:1 }}
                                {% endif %}
                            </strong>
                        </td>
                        <td>
                            {{ calc.mape|floatformat:1 }}%
                            {% with best_mape=calculations|dictsort:"mape"|first %}
                                {% if calc.mape == best_mape.mape %}
                                    <span class="badge bg-success">Terbaik</span>
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td>
                            {{ calc.mae|floatformat:0 }}
                            {% with best_mae=calculations|dictsort:"mae"|first %}
                                {% if calc.mae == best_mae.mae %}
                                    <span class="badge bg-info">Terbaik</span>
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td>
                            {{ calc.mse|floatformat:0 }}
                            {% with best_mse=calculations|dictsort:"mse"|first %}
                                {% if calc.mse == best_mse.mse %}
                                    <span class="badge bg-warning">Terbaik</span>
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td>
                            {% with best_mape=calculations|dictsort:"mape"|first %}
                                {% if calc.mape == best_mape.mape %}
                                    <span class="badge bg-success">MAPE Terbaik</span>
                                {% endif %}
                            {% endwith %}
                            {% with best_mae=calculations|dictsort:"mae"|first %}
                                {% if calc.mae == best_mae.mae %}
                                    <span class="badge bg-info">MAE Terbaik</span>
                                {% endif %}
                            {% endwith %}
                            {% with best_mse=calculations|dictsort:"mse"|first %}
                                {% if calc.mse == best_mse.mse %}
                                    <span class="badge bg-warning">MSE Terbaik</span>
                                {% endif %}
                            {% endwith %}
                        </td>
                        <td class="fw-bold">
                            {{ calc.forecast_next|floatformat:0 }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endfor %}
</div>
            <!-- 5. Semua Rumus Perhitungan -->
            <div class="card p-4 mb-5">
                <h4 class="text-secondary mb-4 text-center">
                    <i class="bi bi-calculator header-icon"></i>Rumus Perhitungan Lengkap
                </h4>

                <div class="row">
                    <!-- Metode Exponential Smoothing -->
                    <div class="col-md-6 mb-4">
                        <div class="calculation-card">
                            <h5 class="text-primary">Metode: Single Exponential Smoothing</h5>
                            <p class="text-muted">
                                Metode pembobotan eksponensial untuk data time series
                            </p>

                            <div class="calculation-card">
                                <strong>Rumus Exponential Smoothing:</strong>
                                <div class="formula">
                                    F<sub>t</sub> = α × A<sub>t-1</sub> + (1-α) × F<sub>t-1</sub>
                                </div>
                                <small class="text-muted">Dimana: F<sub>t</sub> = Forecast periode t, A<sub>t-1</sub> = Actual periode t-1, α = Alpha (konstanta smoothing 0.1-0.9)</small>
                            </div>

                            <div class="calculation-card">
                                <strong>Rumus Forecast Tahun Berikutnya:</strong>
                                <div class="formula">
                                    F<sub>t+1</sub> = α × A<sub>t</sub> + (1-α) × F<sub>t</sub>
                                </div>
                                <small class="text-muted">Forecast untuk tahun berikutnya menggunakan data aktual terakhir dan forecast terakhir</small>
                            </div>
                        </div>
                    </div>

                    <!-- Metode Evaluasi -->
                    <div class="col-md-6 mb-4">
                        <div class="calculation-card">
                            <h5 class="text-primary">Metode Evaluasi Akurasi</h5>
                            
                            <div class="calculation-card">
                                <strong>MAPE (Mean Absolute Percentage Error):</strong>
                                <div class="formula">
                                    MAPE = (1/n) × Σ |(A<sub>t</sub> - F<sub>t</sub>) / A<sub>t</sub>| × 100%
                                </div>
                                <small class="text-muted">Mengukur error dalam persentase relatif. < 10% = Excellent</small>
                            </div>

                            <div class="calculation-card">
                                <strong>MAE (Mean Absolute Error):</strong>
                                <div class="formula">
                                    MAE = (1/n) × Σ |A<sub>t</sub> - F<sub>t</sub>|
                                </div>
                                <small class="text-muted">Mengukur error absolut dalam satuan data asli</small>
                            </div>

                            <div class="calculation-card">
                                <strong>MSE (Mean Squared Error):</strong>
                                <div class="formula">
                                    MSE = (1/n) × Σ (A<sub>t</sub> - F<sub>t</sub>)²
                                </div>
                                <small class="text-muted">Mengukur error kuadrat, sensitif terhadap outlier</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. Grafik -->
            <div class="card p-4 mb-5">
                <h4 class="text-secondary text-center mb-4">
                    <i class="bi bi-graph-up-arrow header-icon"></i>Grafik Perbandingan Hasil Forecasting
                </h4>
                <canvas id="multiChart"></canvas>
            </div>
<div class="card p-4 mb-5">
    <h4 class="text-secondary text-center mb-4">
        <i class="bi bi-bar-chart-fill header-icon"></i>Grafik Perbandingan per Tahun (%)
    </h4>
    <div style="height: 400px; position: relative;"> <!-- Container dengan tinggi tetap -->
        <canvas id="yearlyChart"></canvas>
    </div>
</div>
            <!-- Tambahkan tombol ini di bagian sebelum tombol "Kembali ke Halaman Awal" -->
            <!-- Ganti bagian tombol di akhir halaman dengan ini -->
            <div class="text-center">
                <div class="mb-4">
                    <button id="downloadPdf" class="btn btn-danger me-3">
                        <i class="bi bi-file-pdf me-2"></i>Download PDF Report
                    </button>
                    <a href="/" class="btn btn-primary">
                        <i class="bi bi-arrow-left me-2"></i>Kembali ke Halaman Awal
                    </a>
                </div>
            </div>

            {% endif %}

            <!-- Modal untuk Detail Perhitungan -->
            <div class="modal fade" id="calculationModal" tabindex="-1">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content" style="background-color: #ffffff; color: #212529;">
                        <div class="modal-header" style="background-color: #0d6efd; color: white;">
                            <h5 class="modal-title">Detail Perhitungan Forecasting</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" style="filter: invert(1);"></button>
                        </div>
                        <div class="modal-body" id="calculationDetails" style="background-color: #ffffff; color: #212529;">
                            <!-- Detail perhitungan akan dimuat di sini -->
                        </div>
                        <div class="modal-footer" style="background-color: #f8f9fa;">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                <p>
                    &copy; 2023 Sistem Peramalan Jas Almamater | Analisis Multiple Metode
                </p>
            </div>
        </div>

        <!-- Chart.js script -->
        <script>
            document.addEventListener('DOMContentLoaded', () => {
    try {
        const chartData = {{ chart_data|safe }};
        const labels = {{ years|safe }};
        const colors = [
            '#58a6ff', '#3fb950', '#f85149', '#d29922', '#db61a2', '#8b949e'
        ];

        // === Grafik 1: Tren per ukuran (Line Chart)
        const ctxLine = document.getElementById('multiChart').getContext('2d');
        const datasets = [];

        let i = 0;
        for (const [key, values] of Object.entries(chartData)) {
            if (Array.isArray(values) && values.length > 0) {
                datasets.push({
                    label: key,
                    data: values,
                    borderColor: colors[i % colors.length],
                    backgroundColor: colors[i % colors.length] + '20',
                    borderWidth: 3,
                    tension: 0.3,
                    fill: false,
                    pointRadius: 4,
                    pointHoverRadius: 8,
                    pointBackgroundColor: colors[i % colors.length],
                });
            }
            i++;
        }

        new Chart(ctxLine, {
            type: 'line',
            data: { labels: labels, datasets: datasets },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Trend Forecasting Semua Ukuran',
                        color: '#f0f6fc',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: '#8b949e',
                            font: { size: 12 }
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: '#21262d',
                        titleColor: '#f0f6fc',
                        bodyColor: '#f0f6fc',
                        borderColor: '#30363d',
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Tahun',
                            color: '#8b949e'
                        },
                        grid: { color: '#30363d' },
                        ticks: { color: '#8b949e' }
                    },
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Jumlah Permintaan',
                            color: '#8b949e'
                        },
                        grid: { color: '#30363d' },
                        ticks: { 
                            color: '#8b949e',
                            callback: function(value) {
                                return value.toLocaleString('id-ID');
                            }
                        }
                    }
                }
            }
        });

        // === Grafik 2: Stacked Horizontal Percentage Bar Chart ===
        const ctxBar = document.getElementById('yearlyChart').getContext('2d');

        // Hitung total per tahun
        const yearlyTotals = labels.map((year, index) => {
            return Object.values(chartData).reduce((sum, dataset) => {
                return sum + (dataset[index] || 0);
            }, 0);
        });

        // Konversi ke persentase
        const percentageData = {};
        Object.keys(chartData).forEach(key => {
            percentageData[key] = chartData[key].map((value, index) => {
                const total = yearlyTotals[index];
                return total > 0 ? (value / total) * 100 : 0;
            });
        });

        // Dataset STACKED
        const barDatasets = Object.keys(percentageData).map((key, idx) => ({
            label: key,
            data: percentageData[key],
            backgroundColor: colors[idx % colors.length],
            borderColor: '#ffffff',
            borderWidth: 1,
            barThickness: 26,
            borderRadius: 6
        }));

        // Custom plugin untuk label di dalam bar
        const insideLabelsPlugin = {
            id: 'insideLabels',
            afterDatasetsDraw(chart) {
                const { ctx } = chart;
                ctx.save();

                chart.data.datasets.forEach((dataset, datasetIndex) => {
                    const meta = chart.getDatasetMeta(datasetIndex);

                    meta.data.forEach((bar, index) => {
                        const value = dataset.data[index];
                        // Hanya tampilkan jika persentase cukup besar (>= 5%)
                        if (!value || value < 5) return;

                        // Hitung posisi tengah segmen stacked bar
                        let centerX = bar.x;
                        if (datasetIndex > 0) {
                            // Untuk dataset setelah pertama, hitung posisi berdasarkan segmen sebelumnya
                            const prevMeta = chart.getDatasetMeta(datasetIndex - 1);
                            const prevBar = prevMeta.data[index];
                            centerX = (prevBar.x + bar.x) / 2;
                        } else {
                            // Untuk dataset pertama
                            centerX = bar.x / 2;
                        }

                        const centerY = bar.y;
                        const text = value.toFixed(0) + '%';

                        ctx.font = 'bold 11px Arial';
                        ctx.fillStyle = '#ffffff';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';

                        // Background untuk readability
                        const padding = 4;
                        const textWidth = ctx.measureText(text).width;

                        ctx.fillStyle = 'rgba(0,0,0,0.35)';
                        ctx.fillRect(
                            centerX - textWidth / 2 - padding,
                            centerY - 8,
                            textWidth + padding * 2,
                            16
                        );
                        
                        // Teks persentase
                        ctx.fillStyle = '#ffffff';
                        ctx.fillText(text, centerX, centerY);
                    });
                });
                ctx.restore();
            }
        };

        new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: barDatasets
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Distribusi Permintaan per Tahun (%)',
                        font: { size: 16, weight: 'bold' },
                        color: '#f0f6fc'
                    },
                    legend: {
                        position: 'bottom',
                        labels: {
                            usePointStyle: true,
                            boxWidth: 10,
                            font: { size: 12 },
                            color: '#8b949e'
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: '#21262d',
                        titleColor: '#f0f6fc',
                        bodyColor: '#f0f6fc',
                        borderColor: '#30363d',
                        borderWidth: 1,
                        callbacks: {
                            label(context) {
                                const label = context.dataset.label;
                                const percent = context.raw.toFixed(1);
                                const yearIndex = context.dataIndex;
                                const original = chartData[label][yearIndex] || 0;
                                return `${label}: ${percent}% (${original.toLocaleString('id-ID')})`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        max: 100,
                        ticks: {
                            callback: value => value + '%',
                            color: '#8b949e'
                        },
                        title: {
                            display: true,
                            text: 'Persentase',
                            color: '#8b949e'
                        },
                        grid: { 
                            color: '#30363d',
                            drawBorder: false
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Tahun',
                            color: '#8b949e'
                        },
                        grid: { 
                            display: false,
                            drawBorder: false
                        },
                        ticks: { 
                            color: '#8b949e',
                            padding: 10
                        }
                    }
                }
            },
            plugins: [insideLabelsPlugin] // Masukkan plugin di sini
        });

    } catch (err) {
        console.error("Chart error:", err);
    }
});

            // Theme toggle functionality
            document.getElementById('themeToggle').addEventListener('click', function() {
                const body = document.body;
                const themeIcon = document.getElementById('themeIcon');

                if (body.classList.contains('light-mode')) {
                    // Switch to dark mode
                    body.classList.remove('light-mode');
                    themeIcon.classList.remove('bi-sun-fill');
                    themeIcon.classList.add('bi-moon-fill');
                } else {
                    // Switch to light mode
                    body.classList.add('light-mode');
                    themeIcon.classList.remove('bi-moon-fill');
                    themeIcon.classList.add('bi-sun-fill');
                }
            });

            // Fungsi untuk menampilkan detail perhitungan
            function showCalculation(ukuran, alpha, actualLast, forecastLast, forecastNext) {
                const part1 = (alpha * actualLast).toFixed(2);
                const part2 = ((1 - alpha) * forecastLast).toFixed(2);

                const calculation = `
                    <div class="calculation-card" style="background: #f8f9fa; border-left: 4px solid #58a6ff; padding: 15px; margin: 10px 0; border-radius: 8px;">
                        <h6 class="text-primary" style="color: #0d6efd !important;">Perhitungan Forecast untuk Ukuran <strong style="color: #212529;">${ukuran}</strong>:</h6>
                    </div>

                    <div class="calculation-card" style="background: #f8f9fa; border-left: 4px solid #58a6ff; padding: 15px; margin: 10px 0; border-radius: 8px;">
                        <strong style="color: #212529;">Rumus yang digunakan:</strong>
                        <div class="formula" style="font-family: 'Courier New', monospace; background: #ffffff; padding: 12px; border-radius: 6px; margin: 8px 0; border: 1px solid #dee2e6; color: #212529; font-weight: 500;">
                            F<sub>t+1</sub> = α × A<sub>t</sub> + (1-α) × F<sub>t</sub>
                        </div>
                    </div>

                    <div class="calculation-card" style="background: #f8f9fa; border-left: 4px solid #58a6ff; padding: 15px; margin: 10px 0; border-radius: 8px;">
                        <strong style="color: #212529;">Nilai Variabel:</strong>
                        <div class="calculation-step" style="background: #e9ecef; padding: 10px; border-radius: 6px; margin: 5px 0; border-left: 3px solid #3fb950;">
                            - Alpha (α) = <strong style="color: #212529;">${alpha}</strong><br>
                            - Aktual Terakhir (A<sub>t</sub>) = <strong style="color: #212529;">${actualLast}</strong><br>
                            - Forecast Terakhir (F<sub>t</sub>) = <strong style="color: #212529;">${forecastLast}</strong>
                        </div>
                    </div>

                    <div class="calculation-card" style="background: #f8f9fa; border-left: 4px solid #58a6ff; padding: 15px; margin: 10px 0; border-radius: 8px;">
                        <strong style="color: #212529;">Langkah Perhitungan:</strong>
                        <div class="calculation-step" style="background: #e9ecef; padding: 10px; border-radius: 6px; margin: 5px 0; border-left: 3px solid #3fb950;">
                            1. F<sub>t+1</sub> = ${alpha} × ${actualLast} + (1 - ${alpha}) × ${forecastLast}<br>
                            2. F<sub>t+1</sub> = ${part1} + ${part2}<br>
                            3. F<sub>t+1</sub> = <strong style="color: #198754;">${forecastNext}</strong>
                        </div>
                    </div>

                    <div class="alert alert-success mt-3" style="background-color: #d1e7dd; border-color: #badbcc; color: #0f5132;">
                        <i class="bi bi-check-circle-fill me-2"></i>
                        <strong>Hasil Akhir:</strong> Forecast untuk tahun berikutnya = <strong>${forecastNext}</strong>
                    </div>
                `;


                document.getElementById('calculationDetails').innerHTML = calculation;
                new bootstrap.Modal(document.getElementById('calculationModal')).show();
            }
function safeShowCalculations(ukuran, alpha, actualLast, forecastLast, forecastNext, 
                            mape, mae, mse, metricType, 
                            yearlyCalculations, yearlyMetrics, allAlphasData) {
    try {
        showAllCalculations(ukuran, alpha, actualLast, forecastLast, forecastNext, 
                           mape, mae, mse, metricType, 
                           yearlyCalculations, yearlyMetrics, allAlphasData);
    } catch (error) {
        console.error('Error in showAllCalculations:', error);
        alert('Terjadi kesalahan saat menampilkan detail perhitungan. Coba lagi.');
    }
}

// Tambahkan fungsi helper untuk pembulatan
function formatNumber(num, decimals = 0) {
    if (num === undefined || num === null || isNaN(num)) return '0';
    const multiplier = Math.pow(10, decimals);
    const rounded = Math.round(num * multiplier) / multiplier;
    
    // Untuk bilangan bulat (decimals=0), hapus desimal
    if (decimals === 0) {
        return rounded.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }
    
    // Untuk desimal, format dengan titik sebagai pemisah ribuan
    const parts = rounded.toString().split('.');
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    return parts.join(',');
}

function formatPercentage(num, decimals = 1) {
    if (num === undefined || num === null || isNaN(num)) return '0,0%';
    const multiplier = Math.pow(10, decimals);
    const rounded = Math.round(num * multiplier) / multiplier;
    return rounded.toString().replace('.', ',') + '%';
}

// Fungsi untuk pembulatan dengan format yang sesuai
function roundNumber(num, decimals = 2) {
    if (num === undefined || num === null) return 0;
    return parseFloat(num.toFixed(decimals));
}

// Fungsi khusus untuk format alpha (mempertahankan trailing zero sesuai step)
function formatAlpha(alpha, alphaStep = 0.1) {
    if (alpha === undefined || alpha === null) return '0.00';
    
    const num = parseFloat(alpha);
    
    if (alphaStep === 0.01) {
        // Untuk alpha step 0.01, tampilkan 2 desimal
        return num.toFixed(2);
    } else {
        // Untuk alpha step 0.1, tampilkan 1 desimal
        return num.toFixed(1);
    }
}

// Fungsi untuk format display alpha di tabel - FIXED VERSION
function formatAlphaDisplay(alpha, alphaStep = 0.1) {
    if (alpha === undefined || alpha === null) return '0.00';
    
    // Konversi ke angka
    const num = parseFloat(alpha);
    
    if (alphaStep === 0.01) {
        // Untuk alpha step 0.01, tampilkan 2 desimal
        // Gunakan Math.round untuk menghindari floating point error
        const rounded = Math.round(num * 100) / 100;
        return rounded.toFixed(2);
    } else {
        // Untuk alpha step 0.1, tampilkan 1 desimal
        const rounded = Math.round(num * 10) / 10;
        return rounded.toFixed(1);
    }
}

// Fungsi untuk mendapatkan nilai alpha yang tepat untuk perbandingan
function getExactAlpha(alpha, alphaStep = 0.1) {
    if (alpha === undefined || alpha === null) return 0;
    
    if (alphaStep === 0.01) {
        return Math.round(alpha * 100) / 100;
    } else {
        return Math.round(alpha * 10) / 10;
    }
}
function showAllCalculations(ukuran, alpha, actualLast, forecastLast, forecastNext, 
                            mape, mae, mse, metricType, 
                            yearlyCalculations, yearlyMetrics, allAlphasData, alphaStep = 0.1) {
    
    // Validasi dan pembulatan parameter
    alpha = roundNumber(alpha || 0, 2);
    actualLast = roundNumber(actualLast || 0);
    forecastLast = roundNumber(forecastLast || 0);
    forecastNext = roundNumber(forecastNext || 0);
    mape = roundNumber(mape || 0);
    mae = roundNumber(mae || 0);
    mse = roundNumber(mse || 0);
    metricType = metricType || 'MAPE';
    yearlyCalculations = yearlyCalculations || [];
    yearlyMetrics = yearlyMetrics || [];
    allAlphasData = allAlphasData || [];
    
    // Format alpha untuk display sesuai step
    const alphaDisplay = formatAlphaDisplay(alpha, alphaStep);

    
    // Inline styles untuk tema terang
    const cardStyle = "background: #f8f9fa; border-left: 4px solid #58a6ff; padding: 15px; margin: 10px 0; border-radius: 8px; color: #212529;";
    const stepStyle = "background: #e9ecef; padding: 10px; border-radius: 6px; margin: 5px 0; border-left: 3px solid #3fb950; color: #212529;";
    const formulaStyle = "font-family: 'Courier New', monospace; background: #ffffff; padding: 12px; border-radius: 6px; margin: 8px 0; border: 1px solid #dee2e6; color: #212529; font-weight: 500;";
    const tableHeaderStyle = "background-color: #198754; color: white;";
    const textSuccessStyle = "color: #198754 !important;";
    const textWarningStyle = "color: #ffc107 !important;";
    const textInfoStyle = "color: #0dcaf0 !important;";
    const textDangerStyle = "color: #dc3545 !important;";
    const textPrimaryStyle = "color: #0d6efd !important;";
    
    let html = `
        <div style="${cardStyle}">
            <h6 style="${textPrimaryStyle}">📊 Detail Perhitungan Lengkap - ${metricType} Terbaik</h6>
            <p style="color: #6c757d;">
                Ukuran: <strong style="color: #212529;">${ukuran}</strong> | 
                Alpha Terbaik: <strong style="color: #212529;">${alphaDisplay}</strong> | 
                Tahun Berikutnya: <strong style="color: #212529;">${formatNumber(forecastNext)}</strong>
            </p>
        </div>
    `;

    // 1. TABEL SEMUA ALPHA (0.01 - 0.99) - DARI TERBESAR KE TERKECIL
    if (allAlphasData && allAlphasData.length > 0) {
        // Hitung total kombinasi alpha
        const totalAlphas = allAlphasData.length;
        const alphaCountInfo = totalAlphas >= 99 ? "99 kombinasi alpha" : `${totalAlphas} kombinasi alpha`;
        
        html += `
            <div style="${cardStyle}">
                <h6 style="color: #198754;">📈 Perbandingan Alpha</h6>
                <div class="alert alert-info" style="background-color: #cff4fc; border-color: #b6effb; color: #055160;">
                    <i class="bi bi-info-circle me-2"></i>
                    Total <strong>${alphaCountInfo}</strong> diuji untuk mendapatkan nilai optimal (0.01 - 0.99)
                </div>
                <div class="table-responsive mt-2">
                    <table class="table table-sm table-bordered">
                        <thead style="${tableHeaderStyle}">
                            <tr>
                                <th>No</th>
                                <th>Alpha (α)</th>
                                <th>MAPE (%)</th>
                                <th>MAE</th>
                                <th>MSE</th>
                                <th>Forecast<br>F<sub>t+1</sub></th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
        `;
        
        // Urutkan alpha dari TERBESAR ke TERKECIL (0.99 -> 0.01)
        const sortedAlphas = [...allAlphasData].sort((a, b) => b.alpha - a.alpha);
        
        // Batasi tampilan jika terlalu banyak (misal max 15 baris)
        const displayLimit = 999;
        const displayAlphas = sortedAlphas.slice(0, displayLimit);
        
        displayAlphas.forEach((calc, index) => {
            const isBest = Math.abs(calc.alpha - alpha) < 0.001;
            const alphaDisplay = formatAlphaDisplay(calc.alpha, alphaStep); // Gunakan format khusus
            const mapeValue = roundNumber(calc.mape || 0);
            const mapeClass = mapeValue < 10 ? 'text-success' : mapeValue < 20 ? 'text-warning' : 'text-danger';
            
            html += `
                <tr ${isBest ? 'style="background-color: #fff3cd !important;"' : ''}>
                    <td>${index + 1}</td>
                    <td><strong>${alphaDisplay}</strong></td>
                    <td class="${mapeClass}">${formatNumber(mapeValue)}%</td>
                    <td>${formatNumber(calc.mae || 0)}</td>
                    <td>${formatNumber(calc.mse || 0)}</td>
                    <td><strong>${formatNumber(calc.forecast_next || 0)}</strong></td>
                    <td>
                        ${isBest ? '<span class="badge bg-success">TERBAIK</span>' : ''}
                    </td>
                </tr>
            `;
        });
        
        // Jika ada alpha yang tidak ditampilkan, tambahkan info
        if (sortedAlphas.length > displayLimit) {
            const remainingCount = sortedAlphas.length - displayLimit;
            html += `
                <tr>
                    <td colspan="7" class="text-center" style="background-color: #f8f9fa;">
                        <small class="text-muted">... dan ${remainingCount} alpha lainnya</small>
                    </td>
                </tr>
            `;
        }
        
        html += `
                        </tbody>
                    </table>
                </div>
                <small style="color: #6c757d;">* Menampilkan ${displayLimit} alpha pertama dari terbesar ke terkecil (0.99 → 0.01)</small>
            </div>
        `;
    }

    // 2. DETAIL PERHITUNGAN FORECAST PER ALPHA TERPILIH
    html += `
        <div style="${cardStyle}">
            <h6 style="color: #ffc107;">📋 Detail Perhitungan Forecast dengan Alpha ${alphaDisplay}</h6>
            <div class="alert alert-warning" style="background-color: #fff3cd; border-color: #ffecb5; color: #664d03;">
                <i class="bi bi-calculator me-2"></i>
                <strong>Rumus Exponential Smoothing:</strong><br>
                F<sub>t</sub> = α × A<sub>t-1</sub> + (1-α) × F<sub>t-1</sub>
            </div>
    `;
    
    if (yearlyCalculations && yearlyCalculations.length > 0) {
        html += `
            <div class="table-responsive mt-2">
                <table class="table table-sm table-bordered" style="color: #212529;">
                    <thead style="background-color: #ffc107; color: #212529;">
                        <tr>
                            <th>Tahun (t)</th>
                            <th>Aktual (A<sub>t</sub>)</th>
                            <th>Forecast (F<sub>t</sub>)</th>
                            <th>Perhitungan</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        yearlyCalculations.forEach(calc => {
            // Format calculation string agar angka dibulatkan 2 desimal
            let calculationDisplay = calc.calculation || '';
            if (calculationDisplay) {
                // Ganti angka desimal panjang dengan yang dibulatkan 2 desimal
                calculationDisplay = calculationDisplay
                    .replace(/(\d+\.\d{5,})/g, (match) => {
                        const num = parseFloat(match);
                        return num.toFixed(2);
                    })
                    .replace(/(\d+\.\d{3,})/g, (match) => {
                        const num = parseFloat(match);
                        return num.toFixed(2);
                    });
                
                // Perbaiki angka floating point JavaScript untuk alpha 2 desimal
                calculationDisplay = calculationDisplay
                    .replace(/0\.00999999999999998/g, '0.01')
                    .replace(/0\.01999999999999998/g, '0.02')
                    .replace(/0\.02999999999999998/g, '0.03')
                    .replace(/0\.03999999999999998/g, '0.04')
                    .replace(/0\.04999999999999998/g, '0.05')
                    .replace(/0\.05999999999999998/g, '0.06')
                    .replace(/0\.06999999999999998/g, '0.07')
                    .replace(/0\.07999999999999998/g, '0.08')
                    .replace(/0\.08999999999999998/g, '0.09')
                    .replace(/0\.09999999999999998/g, '0.10')
                    .replace(/0\.19999999999999996/g, '0.20')
                    .replace(/0\.29999999999999993/g, '0.30')
                    .replace(/0\.3999999999999999/g, '0.40')
                    .replace(/0\.4999999999999999/g, '0.50')
                    .replace(/0\.5999999999999999/g, '0.60')
                    .replace(/0\.6999999999999998/g, '0.70')
                    .replace(/0\.7999999999999998/g, '0.80')
                    .replace(/0\.8999999999999998/g, '0.90');
            }
            
            html += `
                <tr>
                    <td><strong>${calc.tahun || '-'}</strong></td>
                    <td>${formatNumber(calc.actual)}</td>
                    <td>${formatNumber(calc.forecast)}</td>
                    <td><small>${calculationDisplay || '-'}</small></td>
                </tr>
            `;
        });
        
        html += `
                    </tbody>
                </table>
            </div>
        `;
    } else {
        html += `<p style="color: #6c757d;">Data perhitungan per tahun tidak tersedia.</p>`;
    }
    
    html += `</div>`;

    // 3. DETAIL METRIK EVALUASI
    if (yearlyMetrics && yearlyMetrics.length > 0) {
        html += `
            <div style="${cardStyle}">
                <h6 style="color: #0dcaf0;">📊 Detail Perhitungan ${metricType}</h6>
                <div class="table-responsive mt-2">
                    <table class="table table-sm table-bordered" style="color: #212529;">
                        <thead style="background-color: #0dcaf0; color: #212529;">
                            <tr>
                                <th>Tahun</th>
                                <th>A<sub>t</sub></th>
                                <th>F<sub>t</sub></th>
                                <th>Error (A<sub>t</sub> - F<sub>t</sub>)</th>
                                <th>Absolute Error<br>|A-F|</th>
                                <th>Squared Error<br>(A-F)²</th>
                                <th>Percentage Error<br>|(A-F)/A|×100%</th>
                            </tr>
                        </thead>
                        <tbody>
        `;
        
        yearlyMetrics.forEach(metric => {
            const error = roundNumber((metric.actual || 0) - (metric.forecast || 0));
            
            html += `
                <tr>
                    <td><strong>${metric.tahun || '-'}</strong></td>
                    <td>${formatNumber(metric.actual)}</td>
                    <td>${formatNumber(metric.forecast)}</td>
                    <td>${formatNumber(error)}</td>
                    <td style="${textInfoStyle}">${formatNumber(metric.absolute_error)}</td>
                    <td style="${textWarningStyle}">${formatNumber(metric.squared_error)}</td>
                    <td style="${textDangerStyle}">${formatNumber(metric.percentage_error)}%</td>
                </tr>
            `;
        });

        // RATA-RATA
        html += `
                            <tr style="background-color: #d1e7dd; font-weight: bold;">
                                <td colspan="4" style="text-align: end;">RATA-RATA →</td>
                                <td style="${textInfoStyle}">${formatNumber(mae)}<br><small>MAE</small></td>
                                <td style="${textWarningStyle}">${formatNumber(mse)}<br><small>MSE</small></td>
                                <td style="${textDangerStyle}">${formatNumber(mape)}%<br><small>MAPE</small></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-3">
                    <h6>Rumus ${metricType}:</h6>
                    <div style="${formulaStyle}">
        `;
        
        if (metricType === 'MAPE') {
            html += `MAPE = (1/n) × Σ |(A<sub>t</sub> - F<sub>t</sub>) / A<sub>t</sub>| × 100% = ${formatNumber(mape)}%`;
        } else if (metricType === 'MAE') {
            html += `MAE = (1/n) × Σ |A<sub>t</sub> - F<sub>t</sub>| = ${formatNumber(mae)}`;
        } else {
            html += `MSE = (1/n) × Σ (A<sub>t</sub> - F<sub>t</sub>)² = ${formatNumber(mse)}`;
        }
        
        html += `
                    </div>
                </div>
            </div>
        `;
    } else {
        html += `
            <div style="${cardStyle}">
                <h6 style="color: #0dcaf0;">📊 Detail Perhitungan ${metricType}</h6>
                <p style="color: #6c757d;">Data metrik evaluasi per tahun tidak tersedia.</p>
                <div style="${formulaStyle}">
                    ${metricType} = ${metricType === 'MAPE' ? formatNumber(mape) + '%' : metricType === 'MAE' ? formatNumber(mae) : formatNumber(mse)}
                </div>
            </div>
        `;
    }

    // 4. PERHITUNGAN FORECAST TAHUN BERIKUTNYA
    // Hitung dengan pembulatan 2 desimal
    const roundedAlpha = roundNumber(alpha, 2);
    const roundedOneMinusAlpha = roundNumber(1 - alpha, 2);
    const part1 = roundNumber(alpha * actualLast, 2);
    const part2 = roundNumber((1 - alpha) * forecastLast, 2);
    const calculatedForecast = roundNumber(part1 + part2, 2);
    
    html += `
        <div style="${cardStyle}">
            <h6 style="${textSuccessStyle}">🔮 Perhitungan Forecast Tahun Berikutnya</h6>
            <div style="${stepStyle}">
                <strong>Rumus:</strong> F<sub>t+1</sub> = α × A<sub>t</sub> + (1-α) × F<sub>t</sub>
            </div>
            <div class="row mt-3">
                <div class="col-md-6">
                    <div style="${stepStyle}">
                        <strong>Nilai Variabel:</strong><br>
                        <table class="table table-sm">
                            <tr><td>Alpha (α)</td><td><strong>= ${roundedAlpha}</strong></td></tr>
                            <tr><td>1 - α</td><td><strong>= ${roundedOneMinusAlpha}</strong></td></tr>
                            <tr><td>Aktual Terakhir (A<sub>t</sub>)</td><td><strong>= ${formatNumber(actualLast)}</strong></td></tr>
                            <tr><td>Forecast Terakhir (F<sub>t</sub>)</td><td><strong>= ${formatNumber(forecastLast)}</strong></td></tr>
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    <div style="${stepStyle}">
                        <strong>Langkah Perhitungan:</strong><br>
                        1. F<sub>t+1</sub> = ${roundedAlpha} × ${formatNumber(actualLast)} + ${roundedOneMinusAlpha} × ${formatNumber(forecastLast)}<br>
                        2. F<sub>t+1</sub> = ${formatNumber(part1)} + ${formatNumber(part2)}<br>
                        3. F<sub>t+1</sub> = <strong style="${textSuccessStyle}">${formatNumber(calculatedForecast)}</strong>
                    </div>
                </div>
            </div>
        </div>
    `;

    // 5. KESIMPULAN
    let badgeClass = 'success';
    let badgeStyle = 'background-color: #d1e7dd; border-color: #badbcc; color: #0f5132;';
    let metricName = '';
    
    if (metricType === 'MAPE') {
        badgeClass = 'success';
        badgeStyle = 'background-color: #d1e7dd; border-color: #badbcc; color: #0f5132;';
        metricName = 'MAPE (Mean Absolute Percentage Error)';
    } else if (metricType === 'MAE') {
        badgeClass = 'info';
        badgeStyle = 'background-color: #cff4fc; border-color: #b6effb; color: #055160;';
        metricName = 'MAE (Mean Absolute Error)';
    } else {
        badgeClass = 'warning';
        badgeStyle = 'background-color: #fff3cd; border-color: #ffecb5; color: #664d03;';
        metricName = 'MSE (Mean Squared Error)';
    }
    
    // Hitung total alpha yang diuji
    const totalAlphaTested = allAlphasData.length;
    
    html += `
        <div class="alert alert-${badgeClass} mt-3" style="${badgeStyle}">
            <i class="bi bi-trophy-fill me-2"></i>
            <strong>Kesimpulan:</strong><br>
            Alpha <strong>${alphaDisplay}</strong> dipilih karena memberikan nilai 
            <strong>${metricType} terkecil</strong> (${metricName}) untuk ukuran ${ukuran}.<br>
            <small>Dari ${totalAlphaTested} kombinasi alpha yang diuji (${allAlphasData.length >= 99 ? '0.01 - 0.99' : 'berbagai nilai alpha'})</small>
        </div>

        <div class="alert alert-success mt-3" style="background-color: #d1e7dd; border-color: #badbcc; color: #0f5132;">
            <i class="bi bi-check-circle-fill me-2"></i>
            <strong>Hasil Prediksi:</strong><br>
            Forecast kebutuhan untuk ukuran ${ukuran} adalah 
            <strong>${formatNumber(forecastNext)} unit</strong>.
        </div>
    `;

    document.getElementById('calculationDetails').innerHTML = html;
    
    // Pastikan modal menggunakan tema terang
    const modalElement = document.getElementById('calculationModal');
    const modalContent = modalElement.querySelector('.modal-content');
    modalContent.style.backgroundColor = '#ffffff';
    modalContent.style.color = '#212529';
    
    new bootstrap.Modal(modalElement).show();
}
function showSimpleCalculation(ukuran, alpha, actualLast, forecastLast, forecastNext, mape, mae, mse, metricType) {
    const part1 = (alpha * actualLast).toFixed(2);
    const part2 = ((1 - alpha) * forecastLast).toFixed(2);
    
    let badgeColor = 'success';
    if (metricType === 'MAE') badgeColor = 'info';
    if (metricType === 'MSE') badgeColor = 'warning';

    const calculation = `
        <div class="calculation-card">
            <h6 class="text-primary">Detail Perhitungan - ${metricType} Terbaik</h6>
            <p class="text-muted mb-3">Ukuran: <strong>${ukuran}</strong> | Alpha: <strong>${alpha}</strong></p>
        </div>

        <div class="calculation-card">
            <strong>Perhitungan Forecast Tahun Berikutnya:</strong>
            <div class="calculation-step">
                F<sub>t+1</sub> = α × A<sub>t</sub> + (1-α) × F<sub>t</sub><br>
                = ${alpha} × ${actualLast} + ${1-alpha} × ${forecastLast}<br>
                = ${part1} + ${part2}<br>
                = <strong>${forecastNext}</strong>
            </div>
        </div>

        <div class="alert alert-${badgeColor} mt-3">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Alpha ${alpha} dipilih</strong> karena memberikan <strong>${metricType} terkecil</strong>
        </div>
    `;

    document.getElementById('calculationDetails').innerHTML = calculation;
    new bootstrap.Modal(document.getElementById('calculationModal')).show();
}
        </script>
        <script>
            
// =========================================================
// ✅ PDF WITH DJANGO TEMPLATE DATA - NO DOM SCRAPING
// =========================================================

function generatePDFWithData() {
    console.log('Starting PDF with template data...');
    
    const btn = document.getElementById('downloadPdf');
    const originalHTML = btn.innerHTML;
    
    // Loading state
    btn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Memproses...';
    btn.disabled = true;
    
    setTimeout(() => {
        try {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            let yPosition = 20;
            const margin = 15;
            const pageWidth = pdf.internal.pageSize.width;
            const pageHeight = pdf.internal.pageSize.height;
            
            // ===== HEADER =====
            pdf.setFontSize(18);
            pdf.setTextColor(0, 0, 128);
            pdf.text('LAPORAN HASIL PERAMALAN JAS ALMAMATER', pageWidth / 2, yPosition, { align: 'center' });
            
            yPosition += 8;
            pdf.setFontSize(10);
            pdf.setTextColor(100, 100, 100);
            pdf.text(`Dibuat pada: ${new Date().toLocaleDateString('id-ID')}`, pageWidth / 2, yPosition, { align: 'center' });
            
            yPosition += 15;
            
            // ===== SUMMARY =====
            pdf.setFontSize(14);
            pdf.setTextColor(0, 0, 0);
            pdf.text('RINGKASAN HASIL', margin, yPosition);
            yPosition += 8;
            
            pdf.setFontSize(10);
            pdf.text(`• Total Ukuran: {{ results|length }}`, margin, yPosition);
            yPosition += 6;
            pdf.text(`• MAPE Terbaik: {{ best_mape }}%`, margin, yPosition);
            yPosition += 6;
            pdf.text(`• Tahun Prediksi: {{ results.0.tahun_next }}`, margin, yPosition);
            yPosition += 6;
            pdf.text(`• Total Perhitungan: {{ total_calculations }} kombinasi`, margin, yPosition);
            yPosition += 15;
            
            // ===== TABLE 1: MAPE TERBAIK =====
            if (yPosition > pageHeight - 50) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.setFontSize(12);
            pdf.setTextColor(0, 100, 0);
            pdf.text('HASIL PREDIKSI - MAPE TERBAIK', margin, yPosition);
            yPosition += 8;
            
            // Table Header
            pdf.setFillColor(0, 100, 0);
            pdf.setTextColor(255, 255, 255);
            pdf.rect(margin, yPosition, pageWidth - 2 * margin, 6, 'F');
            
            pdf.setFontSize(8);
            pdf.text('Ukuran', margin + 2, yPosition + 4);
            pdf.text('Alpha', margin + 25, yPosition + 4);
            pdf.text('MAPE%', margin + 40, yPosition + 4);
            pdf.text('MAE', margin + 60, yPosition + 4);
            pdf.text('MSE', margin + 80, yPosition + 4);
            pdf.text('Aktual', margin + 100, yPosition + 4);
            pdf.text('Forecast', margin + 120, yPosition + 4);
            pdf.text('Trend', margin + 150, yPosition + 4);
            
            yPosition += 8;
            
            // Table Data - Using Django template data
            pdf.setFontSize(8);
            pdf.setTextColor(0, 0, 0);
            
            {% for r in results %}
            if (yPosition > pageHeight - 10) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.text('{{ r.ukuran }}', margin + 2, yPosition);
            pdf.text('{{ r.alpha_mape }}', margin + 25, yPosition);
            pdf.text('{{ r.mape }}%', margin + 40, yPosition);
            pdf.text('{{ r.mae }}', margin + 60, yPosition);
            pdf.text('{{ r.mse }}', margin + 80, yPosition);
            pdf.text('{{ r.actual_last }}', margin + 100, yPosition);
            pdf.text('{{ r.forecast_next }}', margin + 120, yPosition);
            pdf.text('{{ r.forecast_trend }}', margin + 150, yPosition);
            
            yPosition += 5;
            {% endfor %}
            
            yPosition += 10;
            
            // ===== TABLE 2: MAE TERBAIK =====
            if (yPosition > pageHeight - 50) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.setFontSize(12);
            pdf.setTextColor(0, 0, 150);
            pdf.text('HASIL PREDIKSI - MAE TERBAIK', margin, yPosition);
            yPosition += 8;
            
            // Table Header
            pdf.setFillColor(0, 0, 150);
            pdf.setTextColor(255, 255, 255);
            pdf.rect(margin, yPosition, pageWidth - 2 * margin, 6, 'F');
            
            pdf.setFontSize(8);
            pdf.text('Ukuran', margin + 2, yPosition + 4);
            pdf.text('Alpha', margin + 25, yPosition + 4);
            pdf.text('MAPE%', margin + 40, yPosition + 4);
            pdf.text('MAE', margin + 60, yPosition + 4);
            pdf.text('MSE', margin + 80, yPosition + 4);
            pdf.text('Aktual', margin + 100, yPosition + 4);
            pdf.text('Forecast', margin + 120, yPosition + 4);
            pdf.text('Trend', margin + 150, yPosition + 4);
            
            yPosition += 8;
            
            // Table Data
            pdf.setFontSize(8);
            pdf.setTextColor(0, 0, 0);
            
            {% for r in mae_best_results %}
            if (yPosition > pageHeight - 10) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.text('{{ r.ukuran }}', margin + 2, yPosition);
            pdf.text('{{ r.alpha }}', margin + 25, yPosition);
            pdf.text('{{ r.mape }}%', margin + 40, yPosition);
            pdf.text('{{ r.mae }}', margin + 60, yPosition);
            pdf.text('{{ r.mse }}', margin + 80, yPosition);
            pdf.text('{{ r.actual_last }}', margin + 100, yPosition);
            pdf.text('{{ r.forecast_next }}', margin + 120, yPosition);
            pdf.text('{{ r.forecast_trend }}', margin + 150, yPosition);
            
            yPosition += 5;
            {% endfor %}
            
            yPosition += 10;
            
            // ===== TABLE 3: MSE TERBAIK =====
            if (yPosition > pageHeight - 50) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.setFontSize(12);
            pdf.setTextColor(150, 100, 0);
            pdf.text('HASIL PREDIKSI - MSE TERBAIK', margin, yPosition);
            yPosition += 8;
            
            // Table Header
            pdf.setFillColor(150, 100, 0);
            pdf.setTextColor(255, 255, 255);
            pdf.rect(margin, yPosition, pageWidth - 2 * margin, 6, 'F');
            
            pdf.setFontSize(8);
            pdf.text('Ukuran', margin + 2, yPosition + 4);
            pdf.text('Alpha', margin + 25, yPosition + 4);
            pdf.text('MAPE%', margin + 40, yPosition + 4);
            pdf.text('MAE', margin + 60, yPosition + 4);
            pdf.text('MSE', margin + 80, yPosition + 4);
            pdf.text('Aktual', margin + 100, yPosition + 4);
            pdf.text('Forecast', margin + 120, yPosition + 4);
            pdf.text('Trend', margin + 150, yPosition + 4);
            
            yPosition += 8;
            
            // Table Data
            pdf.setFontSize(8);
            pdf.setTextColor(0, 0, 0);
            
            {% for r in mse_best_results %}
            if (yPosition > pageHeight - 10) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.text('{{ r.ukuran }}', margin + 2, yPosition);
            pdf.text('{{ r.alpha }}', margin + 25, yPosition);
            pdf.text('{{ r.mape }}%', margin + 40, yPosition);
            pdf.text('{{ r.mae }}', margin + 60, yPosition);
            pdf.text('{{ r.mse }}', margin + 80, yPosition);
            pdf.text('{{ r.actual_last }}', margin + 100, yPosition);
            pdf.text('{{ r.forecast_next }}', margin + 120, yPosition);
            pdf.text('{{ r.forecast_trend }}', margin + 150, yPosition);
            
            yPosition += 5;
            {% endfor %}
            
            yPosition += 15;
            
            // ===== ALL ALPHA COMPARISON =====
            {% for ukuran, calculations in all_calculations.items %}
            if (yPosition > pageHeight - 50) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.setFontSize(11);
            pdf.setTextColor(0, 0, 0);
            pdf.text(`PERBANDINGAN SEMUA ALPHA - {{ ukuran }}`, margin, yPosition);
            yPosition += 6;
            
            // Sub-header
            pdf.setFontSize(7);
            pdf.setTextColor(100, 100, 100);
            pdf.text('Alpha', margin + 2, yPosition);
            pdf.text('MAPE%', margin + 15, yPosition);
            pdf.text('MAE', margin + 30, yPosition);
            pdf.text('MSE', margin + 45, yPosition);
            pdf.text('Forecast', margin + 60, yPosition);
            
            yPosition += 4;
            
            {% for calc in calculations %}
            if (yPosition > pageHeight - 10) {
                pdf.addPage();
                yPosition = margin;
            }
            
            pdf.setFontSize(7);
            pdf.setTextColor(0, 0, 0);
            
            pdf.text('{{ calc.alpha }}', margin + 2, yPosition);
            pdf.text('{{ calc.mape }}%', margin + 15, yPosition);
            pdf.text('{{ calc.mae }}', margin + 30, yPosition);
            pdf.text('{{ calc.mse }}', margin + 45, yPosition);
            pdf.text('{{ calc.forecast_next }}', margin + 60, yPosition);
            
            yPosition += 4;
            {% endfor %}
            
            yPosition += 8;
            {% endfor %}
            
            // ===== FOOTER =====
            const pageCount = pdf.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                pdf.setPage(i);
                pdf.setFontSize(8);
                pdf.setTextColor(100, 100, 100);
                pdf.text(`Halaman ${i} dari ${pageCount}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
            }
            
            // Save PDF
            const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '');
            pdf.save(`Laporan-Peramalan-${timestamp}.pdf`);
            
            console.log('PDF dengan data template berhasil dibuat!');
            
        } catch (error) {
            console.error('Error creating PDF:', error);
            alert('Gagal membuat PDF: ' + error.message);
        } finally {
            // Restore button
            btn.innerHTML = originalHTML;
            btn.disabled = false;
        }
    }, 100);
}

// =========================================================
// 🎯 SIMPLE EVENT HANDLER
// =========================================================

function initializePDF() {
    const btn = document.getElementById('downloadPdf');
    if (btn) {
        // Remove any existing listeners
        btn.replaceWith(btn.cloneNode(true));
        
        // Get new reference
        const newBtn = document.getElementById('downloadPdf');
        
        // Add click handler
        newBtn.addEventListener('click', function(e) {
            e.preventDefault();
            generatePDFWithData();
        });
        
        console.log('PDF button initialized successfully');
    }
}

// Initialize when page loads
document.addEventListener('DOMContentLoaded', initializePDF);

// Backup initialization
setTimeout(initializePDF, 500);
        </script>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    </body>
    </html>